{
  "name": "snort-socket",
  "version": "0.0.22a",
  "description": "A listener to capture Snort events via the UNIX Socket output plugin, alert_unixsock",
  "notes": "There were no uncommitted modifications in this build",
  "main": "index.js",
  "repository": {
    "type": "svn",
    "url": "http://xp-dev.com/svn/jimbobmcgee-nodejs/snort-socket/trunk",
    "revision": "22",
    "commit_date": "2012-06-19T22:54:09",
    "id_string": "$Id: package.json.template 22 2012-06-19 21:54:09Z jimbobmcgee $"
  },
  "bugs": {
    "email": "snort-socket.npmjs.org@jimbobmcgee.com"
  },
  "optionalDependencies": {
    "unix-dgram": "*"
  },
  "readme": "SnortSocket\n===========\nA NodeJS listener to capture [Snort][3] events via the UNIX Socket output plugin, alert_unixsock\n--------------------------------------------------------------------\n\nThis project aims to provide a simple listener for the alerts raised by the popular [Snort][3] IDS, \nallowing for custom actions to be fired in response to the alerts.\n\n## Basics\nThe following shows the simplest way to start listening for [Snort][3] alerts, using the default \noptions and echoing the alert information to the screen:\n\n    var SnortSocket = require('snort-socket').SnortSocket;\n    var socket = new SnortSocket();\n    socket.on('alert', function(a) { console.log(util.inspect(a)); });\n    socket.bind('/var/log/snort/snort_alert');\n\n\t\n## Dependencies\n* [Snort][3], _Baker, Roesch, SourceFire Inc._\nThis project is designed to capture alerts emitted by the Snort IDS, so Snort is required to \ngenerate these alerts.\n\n* [unix-dgram][2], _Ben Noordhuis, et al_\nRequired when using NodeJS v0.6+, as native support for UNIX Datagram sockets was removed.\nOptional when using lesser versions of NodeJS, but can be invoked using the `forceUnixDgram` option\n(see below).\n\t\n## Setting up\nYou should include the following output plugin configuration in your `snort.conf` (or \n`barnyard.conf`, if you prefer):\n\n    output alert_unixsock\n\t\nThe NodeJS script that executes consuming code should run on the same machine and under the same \nuser account as the [Snort][3] daemon, otherwise [Snort][3] will not write to the socket created by\nNodeJS.  This may be resolvable with the correct owner/group permissions but these are not \ncontrollable via the SnortSocket object.\n\n\n\n## API\nThe module provides the following objects/methods:\n\n### Object: `SnortSocket([options]);`\n\nCreates a new instance of the `SnortSocket` listener.\n\n#### Examples\n* `var s = new SnortSocket();`\n* `var s = new SnortSocket({ bigEndian: true });`\n\n#### Options\n`options` is an object hash that can contain the following values:\n\n* `alertMessageLength`\t_[Number; defaults to `256`]_ <br />\n  Defines the maximum length of the message that will be emitted by [Snort][3].  This is not \n  expected to change from `256` but, if future/custom versions of [Snort][3] are released with a\n  different value, this option will allow SnortSocket to be made to match.  This should always be \n  made to tally with the `ALERTMSG_LENGTH` definition in the source code of your version of \n  [Snort][3].\n\n* `snapshotLength`\t\t_[Number; defaults to `65536`]_ <br />\n  Defines the maximum length of the data packet included in alerts emitted by [Snort][3].  Earlier\n  versions of [Snort][3] had this fixed to `1500`, but more-recent versions have increased this to\n  `65536`.  This should always be made to tally with the `SNAPLEN` definition in the source code \n  of your version of [Snort][3].\n\n* `forceUnixDgram`\t\t_[Boolean; defaults to `false`]_ <br />\n  If `true`, SnortSocket will use the [`unix-dgram`][2] module to create the underlying UNIX \n  datagram socket, regardless of the running version of NodeJS; otherwise, the native `dgram` \n  module is used in versions of NodeJS less than v0.6.\n\n* `bigEndian`\t\t\t_[Boolean; defaults to `false`]_ <br />\n  If `true`, reads integers from the alert data using big-endian read routines; otherwise uses the\n  little-endian routines.  This does not affect data that is read from the packet snapshot, which \n  should always be in network order (big endian).  This may need to be set to `true` on known\n  big-endian platforms (although I do not run one for test purposes).\n\n* `debug`\t\t\t\t_[Boolean; defaults to `false`]_ <br />\n  If `true`, spools debug messages to the console; otherwise the SnortSocket runs with no output.\n\n\n### Method: `socket.bind(socketPath, [callback]);`\n\nBinds the listener to the supplied `socketPath`.\n\n#### Parameters\n* `socketPath` \t\t\t_[String; no default]_ <br />\nThe path to the `snort_alert` socket, which typically exists in the logging directory configured\nin `snort.conf`.  If a file already exists with that path, it is first unlinked (deleted) before\nthe socket is bound.\n\n* `callback`\t\t\t_[Function(err:Error); default `function() { }`]_ <br />\nA function to be run once the bind operation is completed.  If an error occurs during the bind\nprocess, it is passed as the first argument to this function; otherwise the bind is successful.\n\n#### Example\n* `socket.bind('/var/log/snort/snort_alert');`\n* `socket.bind('/var/log/snort/snort_alert', function(err) { if (!!err) throw err; });`\n\n\n### Method: `socket.close([callback]);`\n\nCloses the underlying socket, preventing further alerts from being handled.\n\n#### Parameters\n* `callback`\t\t\t_[Function(); default `function() { }`]_ <br />\nA function to be run once the close operation is completed and the underlying socket has emitted\nits close event.\n\n#### Example\n* `socket.close(function() { console.log('closed'); });`\n* `socket.close();`\n\n\n### Event: `listening`\t_[Function()]_\n\nEmitted by the SnortSocket when it has initialized and is actively listening for alerts\n\n### Event: `error`\t\t_[Function(err:Error)]_\n\nEmitted by the SnortSocket when it has recovered from an exception.  The raised exception will be\npassed as the first parameter to the handler function\n\n### Event: `close`\t\t_[Function(didError:Boolean)]_\n\nEmitted by the SnortSocket when it has disconnected from the underlying socket and is no longer\nlistening for events.  If the underling socket closed because of an exception, `didError` will be\n`true`; otherwise `false`\n\n### Event: `alert`\t\t_[Function(alert:Alert)]_\n\nEmitted by the SnortSocket when it has received an alert from the [Snort][3] IDS.  Details of the\nalert are provided as the first parameter to the handler function; see the Alert object section\n\n\n## Alerts\nAlerts details are emitted by the `alert` event, as an nested object hash with a number of \nproperties describing the event.  These properties are as follows:\n\n* `message`\t\t\t\t\t_[String]_ &mdash; Descriptive text for the alert\n* `protocol.ip`\t\t\t\t_[Number]_ &mdash; The IP version of the packet that caused the alert\n* `protocol.id`\t\t\t\t_[Number]_ &mdash; The protocol number for the packet (e.g. 6 = TCP; 17 = UDP)\n* `protocol.name`\t\t\t_[String]_ &mdash; A name representation of the protocol ID (e.g. `tcp`, `udp`)\n* `protocol.fields` \t\t_[Object]_ &mdash; Reserved for protocol-specific fields (e.g. ICMP type)\n* `source.address`\t\t\t_[String]_ &mdash; The IP address from which the alerting packet arrived\n* `source.port`\t\t\t\t_[Number]_ &mdash; The TCP/UDP port on which the alerting packet arrived\n* `destination.address`\t\t_[String]_ &mdash; The IP address to which the alerting packet was sent\n* `destination.port`\t\t_[Number]_ &mdash; The TCP/UDP port to which the alerting packet was sent\n* `event.id`\t\t\t\t_[Number]_ &mdash; A unique event ID provided by [Snort][3]\n* `event.ref`\t\t\t\t_[Number]_ &mdash; A reference to a previous event ID, if linked\n* `event.class`\t\t\t\t_[Number]_ &mdash; The alert classification value provided by [Snort][3]\n* `event.priority`\t\t\t_[Number]_ &mdash; The alert priorty value provided by [Snort][3]\n* `event.timestamp.seconds`\t_[Number]_ &mdash; The alert time, in number of seconds since 1970-01-01T00:00:00Z\n* `event.timestamp.micros`\t_[Number]_ &mdash; The number of microseconds in addition to the alert time in seconds\n* `event.timestamp.date`\t_[Date]_ &mdash; The JS date representation of the alert time (to nearest millisecond)\n\n\n## Compatibility Issues\n* The `alert_unixsock` output plugin for [Snort][3] only works in UNIX/Linux-type systems; \n  likewise, the SnortSocket module is only supported on UNIX/Linux-type systems\n* Earlier versions of NodeJS had native support for UNIX datagram sockets, but this was removed in\n  v0.6.  The optional dependency [`unix-dgram`][2] is required for use with NodeJS v0.6+\n* The UNIX datagram support in earlier versions of NodeJS limited the maximum size of a received\n  datagram to 65,536B.  Newer versions of Snort exceed this datagram size, which makes capturing\n  full details of the alert impossible.  As such, SnortSocket will only work with the older, native\n  UNIX datagram module if the Snort code was compiled with a `SNAPLEN` value (and, subsequently,\n  the SnortSocket object was created with the `snapshotLength` option) small enough to fit inside \n  the 65,536B limit.  If not, the use of [`unix-dgram`][3] must be forced with the `forceUnixDgram`\n  option.\n\n\t\n## Licensing\nThe SnortSocket code is licensed under the MIT license, where applicable, which is included at the \ntop of each source file and is duplicated below:\n\n>\tCopyright (c) 2012 Jamie Barnes\n>   \n>\tPermission is hereby granted, free of charge, to any person obtaining a copy of this \n>\tsoftware and associated documentation files (the \"Software\"), to deal in the Software \n>\twithout restriction, including without limitation the rights to use, copy, modify, merge, \n>\tpublish, distribute, sublicense, and/or sell copies of the Software, and to permit persons \n>\tto whom the Software is furnished to do so, subject to the following conditions:\n>    \n>\tThe above copyright notice and this permission notice shall be included in\n>\tall copies or substantial portions of the Software.\n>    \n>\tTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING\n>\tBUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND \n>\tNONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, \n>\tDAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \n>\tOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.  \n\t\nThe SnortSocket code does not include any portion of the [Snort][3] codebase but can read data exported \nby [Snort][3], which requires knowledge of the data format derived from the [Snort][3] source files.  As \nsuch, some artifacts from the original source files may exist within the SnortSocket source, in\nreference comments, but these do not form part of the executing code.\n\nThis project is not affiliated with the [Snort][3] project, or its creators/maintainers, and no\nwarranty, copyright or ownership regarding the [Snort][3] project is implied.  For the avoidance of \ndoubt, however, [Snort][3] is licensed under the General Public License v2, the full text of which is \navailable at [http://www.gnu.org/licenses/gpl-2.0.html][1].\n\n----\n_$Id: readme.md 22 2012-06-19 21:54:09Z jimbobmcgee $_\n\n[1]: http://www.gnu.org/licenses/gpl-2.0.html\n[2]: https://github.com/bnoordhuis/node-unix-dgram/\n[3]: http://www.snort.org/",
  "readmeFilename": "readme.md",
  "_id": "snort-socket@0.0.22a",
  "dependencies": {
    "unix-dgram": "*"
  },
  "_from": "snort-socket"
}
